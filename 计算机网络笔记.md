# 计算机网络笔记

## 1 概述

### OSI 7层模型

本质上七层模型是个一个分步解决问题的过程.



应用层: 能够产生网络流量能够壳用户交互的程序

表示层: 加密 压缩 开发人员需要关心的问题

会话层: 服务和客户端建立的会话,占用端口的就是会话. netstat -nb 

传输层: 可靠传输 不可靠传输 流量控制 比如qq发送消息,没必要建立会话.

网络层: IP地址编址 选择最佳协议

数据链路层: 数据如何封装 添加物理层地址 MAC地址

物理层: 电压 接口标准

> tips: 网络排错 一般从底层往高层解决. 底层更简单 

网络安全和OSI参考模型

物理层安全 

数据链路层安全 ADSL WIFI密码

网络层安全 设置网段能否连接广域网

应用层安全 SQL注入漏洞 文件上传漏洞

> 几个概念: 
>
> ​    实体: 交换信息的硬件或软件进程
>
> ​    协议: 控制对等实体通信的规则
>
> ​    服务: 下层对上层提供的接口等
>
> ​    服务访问点: 相邻两层实体间交换信息的地方



### TCP/IP模型

应用层: 传输数据单元 PDU

传输层: 传输层报文

网络层: IP数据报

数据链路层: 数据帧

物理层: bit流

## 物理层

## 数据链路层

数据帧格式

| 6        | 6      | 4        | 2    | 46-1500 | 4    |
| -------- | ------ | -------- | ---- | ------- | ---- |
| 目的地址 | 源地址 | VLAN标记 | 类型 | 数据    | FCS  |

两种广播形式:

- 点对点
- 广播

功能: 

- 封装成帧: 加帧头帧尾
- 透明传输: 添加转义字符,避免提前结束
- 差错控制: 检测数据的错误,但不纠错,循环冗余检验

### PPP 1992(点对点方式): 

**<img src="/home/fa/.config/Typora/typora-user-images/image-20200827120948303.png" alt="image-20200827120948303" style="zoom:50%;" />**



### CSMA/CD(载波监听多点接入/碰撞检测 广播方式) 

特点:

- 半双工 
- 争用期: 经过两倍的发送到达时间后,可以确定消息可以发送成功.
  - 最短有效帧长: 64字节
  - 二进制指数类型退避算法: 发生碰撞后要推迟一个随机时间在发送

 ## mac地址

mac地址是硬件的编号,一共48位16进制位

> tips: ip show interface



## vlan(虚拟局域网)

一个VLAN = 一个广播域 = 一个逻辑网段

功能: 让不同交换机中的主机连接到同一个网段中.

在思科交换机中配置vlan

```bash
config t
show vlan 
vlan 2 
interface range fastEthernet 0/13 - 24
switchport access vlan 2
```

案例: 控制网线的接入设备数量

```bash
show mac-address-tables
config t 
interface range fastEthernet 0/1 - 4 
switchport mode access # 指定只能计算机接入
switchport port-security
switchport port-security violation shutdown
switchport port-security mac-address sticky

```

# 网络层

**网络层提供两种服务:**

- 虚点路服务: 虚电路表述在数据传输过程中形成一种逻辑电路,而不是物理的.
- 数据报服务: 网络层向上只提供简单灵活的,无连接的,尽最大努力交付的数据报(最终选择)

> 中继系统:
>
> - 物理层: 转发器(repeater,hub)
> - 数据链路层: 网桥(bridge)
> - 网络层: 路由器(router)
> - 网络层往上: 网关(gateway)

**网络层协议:**

- ARP
- 
- ICMP
- IGMP
- <img src="/home/fa/.config/Typora/typora-user-images/image-20200829105228336.png" alt="image-20200829105228336" style="zoom:67%;" />

**网际协议 IP**

  IP层次结构: 

- 层次化IP地址将32位IP划分位网路和主机两个部分
- 根据网络ID的长度又分为ADCDE类地址.

> 二进制与十进制关系:
>
> <img src="/home/fa/.config/Typora/typora-user-images/image-20200829111658759.png" alt="image-20200829111658759" style="zoom:50%;" />

0()开头是A类, 10(128始)开头是B类 110(192始)开头是C类

> tips: 特殊地址
>
> - 回环地址: 127.0.0.1	
> - 默认IP: 169.254.0.*
> - 保留私网地址: 10.0.0.0 172.16.0.0-172.31.0.0 192.168.0.0-192.168.255.0

子网掩码:

- 与IP与得到网络位,其余为主机位
- 作用: 判断网段,当连接地址不在同一网段,则交给路由

子网划分:IP地址主机段除四余0或3不行(因为不能全零或全一)

**IP和MAC的区别: IP地址决定最终地址,MAC地址决定下一跳的地址**

**交换机基于数据帧的MAC地址转发数据帧,路由器基于数据报的IP转发**

**数据报在传输过程不变,过网络设备的数据帧要用新的物理层地址重新封装**

**ARP协议**(网络地址转换)

- APR Ip地址转为MAC地址
- RARP  MAC地址转为IP地址

**数据报首部**

- IP数据报由首部和数据两部分组成
- 首部的前一部分是20字节的固定长度,后一部分是可选字节,长度可变.

![IP数据报组成](https://raw.githubusercontent.com/fz-wu/blog_img/master/img/20200830104210.png)



网际控制报文协议 ICMP

因特网的路由选择协议

IP多播

VPN

NAT













